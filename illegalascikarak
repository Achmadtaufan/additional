SELECT 
    e.filename,
    illegal.illegal_positions
FROM excelupload e
CROSS APPLY (
    SELECT STRING_AGG(
        CONCAT('[pos=', v.number, ' char=', SUBSTRING(e.filename, v.number, 1), 
               ' code=', UNICODE(SUBSTRING(e.filename, v.number, 1)), ']'), ', '
    ) AS illegal_positions
    FROM master..spt_values v
    WHERE v.type = 'P'
      AND v.number BETWEEN 1 AND LEN(e.filename)
      AND (
          UNICODE(SUBSTRING(e.filename, v.number, 1)) < 32
          OR UNICODE(SUBSTRING(e.filename, v.number, 1)) > 126
      )
) AS illegal
WHERE illegal.illegal_positions IS NOT NULL;