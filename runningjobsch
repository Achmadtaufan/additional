SELECT 
    j.name AS JobName,
    sj.step_name AS StepName,
    s.name AS ScheduleName,
    js.next_run_date,
    js.next_run_time,
    last_run_time = 
        CASE 
            WHEN h.run_status IS NULL THEN NULL
            ELSE CONVERT(DATETIME, RTRIM(run_date)) + 
                ((run_time / 10000 * 3600) + 
                ((run_time % 10000) / 100 * 60) + 
                (run_time % 10000) % 100) / (86399.9964)
        END
FROM msdb.dbo.sysjobs j
INNER JOIN msdb.dbo.sysjobschedules js ON j.job_id = js.job_id
INNER JOIN msdb.dbo.sysschedules s ON js.schedule_id = s.schedule_id
INNER JOIN msdb.dbo.sysjobsteps sj ON j.job_id = sj.job_id
LEFT JOIN msdb.dbo.sysjobhistory h ON j.job_id = h.job_id
WHERE 
    js.next_run_time = 43200  -- 04.32 dihitung dalam detik (jam * 3600 + menit * 60)
    AND s.enabled = 1  -- pastikan schedule aktif
    AND h.step_id = 0
    AND h.run_date = (SELECT MAX(run_date) FROM msdb.dbo.sysjobhistory WHERE job_id = j.job_id)
