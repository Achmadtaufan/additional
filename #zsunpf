SELECT 
    CONCAT(MAX(BATCACTYR), 
           CASE 
               WHEN LEN(CAST(MAX(BATCACTMN) AS VARCHAR)) = 1 THEN '0' + CAST(MAX(BATCACTMN) AS VARCHAR)
               ELSE CAST(MAX(BATCACTMN) AS VARCHAR)
           END) AS PERIODE, 
    LEFT(RLDGACCT, 8) AS POLICYNUM,
    SUM(IIF(GLSIGN = '-', ORIGAMT * -1, ORIGAMT)) AS SUM_ORIGAMT 
INTO 
    #ZSUNPF_ROP
FROM 
    STG..STG_ZSUNPF WITH(NOLOCK)
WHERE 
    CONCAT(SACSCODE, SACSTYP) IN ('LPSR') 
    AND LEFT(RLDGACCT, 8) <> '' 
GROUP BY 
    LEFT(RLDGACCT, 8)
HAVING 
    SUM(IIF(GLSIGN = '-', ORIGAMT * -1, ORIGAMT)) <> 0
