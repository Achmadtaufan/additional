DECLARE @schema SYSNAME = 'dbo';
DECLARE @table SYSNAME = 'ztemptes';
DECLARE @full NVARCHAR(517) = QUOTENAME(@schema) + '.' + QUOTENAME(@table);
DECLARE @sql NVARCHAR(MAX);

SELECT @sql = STRING_AGG(
    'SELECT ' + QUOTENAME(name,'''') + ' AS ColumnName, COUNT(*) AS JumlahError' +
    ' FROM ' + @full +
    ' WHERE TRY_CONVERT(VARCHAR(4000), ' + QUOTENAME(name) + ') IS NULL AND ' + QUOTENAME(name) + ' IS NOT NULL'
, ' UNION ALL ')
FROM sys.columns
WHERE object_id = OBJECT_ID(@full);

IF @sql IS NULL OR LEN(@sql) = 0
BEGIN
    PRINT 'Tabel tidak ditemukan atau tidak ada kolom.';
END
ELSE
BEGIN
    PRINT 'Menjalankan query:';
    PRINT @sql; -- opsional
    EXEC sp_executesql @sql;
END