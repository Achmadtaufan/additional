SELECT 
    -- Send hour from, diubah menjadi tipe data TIME
    sendhourfrom = CONVERT(TIME, 
                           RIGHT('00' + CAST(CAST(h.value AS INT) / 100 AS VARCHAR(2)), 2) + ':' + 
                           RIGHT('00' + CAST(CAST(h.value AS INT) % 100 AS VARCHAR(2)), 2)),

    -- Send hour to, 30 menit setelah sendhourfrom
    sendhourto = CONVERT(TIME, 
                         RIGHT('00' + CAST(CAST(h.value AS INT) / 100 AS VARCHAR(2)), 2) + ':' + 
                         RIGHT('00' + CAST((CAST(h.value AS INT) % 100 + 30) % 60 AS VARCHAR(2)), 2)),

    -- Report ID
    m.REPORTID  

FROM 
    [MS_SENDRPTCONFIG] m (NOLOCK)   -- Report configuration table with NOLOCK for performance
JOIN 
    MS_SENDRPTSCHEDULE s (NOLOCK)   -- Report schedule table with NOLOCK
    ON s.REPORTID = m.REPORTID    -- Join condition on REPORTID
CROSS APPLY 
    STRING_SPLIT(CAST(s.[HOUR] AS VARCHAR(50)), ';') h  -- Split the HOUR column by semicolon (;) into rows

WHERE 
    m.REPORTID = '753';  -- Filter the results for a specific report ID
